##############################################
# Player decisions: Automatic Title Automanagement
# Provides enable/disable decisions for auto-create/grant duchies and kingdoms.
# Enable decisions shown when flag is off; disable when on.
##############################################

riseandfall_enable_auto_create_duchies = {
    picture = { reference = "gfx/interface/illustrations/decisions/decision_misc.dds" }
    sort_order = 10
    ai_check_interval = 0
    desc = riseandfall_enable_auto_create_duchies_desc
    selection_tooltip = riseandfall_enable_auto_create_duchies_tooltip
    decision_group_type = riseandfall

    is_shown = { always = yes NOT = { exists = global_var:riseandfall_hide_other_decisions } }

    is_valid = { is_landed = yes }

    effect = { riseandfall_player_create_duchies_se = yes }

    ai_potential = {}
    ai_will_do = { base = 0 }
}

 
riseandfall_enable_auto_create_kingdoms = {
    picture = { reference = "gfx/interface/illustrations/decisions/decision_misc.dds" }
    sort_order = 12
    ai_check_interval = 0
    desc = riseandfall_enable_auto_create_kingdoms_desc
    selection_tooltip = riseandfall_enable_auto_create_kingdoms_tooltip
    decision_group_type = riseandfall

    is_shown = { always = yes NOT = { exists = global_var:riseandfall_hide_other_decisions } }

    is_valid = { is_landed = yes }

    effect = { riseandfall_player_create_kingdoms_se = yes }

    ai_potential = {}
    ai_will_do = { base = 0 }
}

 
riseandfall_grant_duchies = {
    picture = { reference = "gfx/interface/illustrations/decisions/decision_misc.dds" }
    sort_order = 14
    ai_check_interval = 0
    desc = riseandfall_grant_duchies_desc
    selection_tooltip = riseandfall_grant_duchies_tooltip
    decision_group_type = riseandfall

    is_shown = { is_landed = yes NOT = { exists = global_var:riseandfall_hide_other_decisions } }

    is_valid = { is_landed = yes }

    # Manual grant: run the player duchy grant scripted effect immediately
    effect = { riseandfall_player_grant_duchies_se = yes }

    ai_potential = {}
    ai_will_do = { base = 0 }
}


riseandfall_grant_kingdoms = {
    picture = { reference = "gfx/interface/illustrations/decisions/decision_misc.dds" }
    sort_order = 16
    ai_check_interval = 0
    desc = riseandfall_grant_kingdoms_desc
    selection_tooltip = riseandfall_grant_kingdoms_tooltip
    decision_group_type = riseandfall

    is_shown = { is_landed = yes NOT = { exists = global_var:riseandfall_hide_other_decisions } }

    is_valid = { is_landed = yes }

    # Manual grant: run the player kingdom grant scripted effect immediately
    effect = { riseandfall_player_grant_kingdoms_se = yes }

    ai_potential = {}
    ai_will_do = { base = 0 }
}



riseandfall_grant_counties = {
    picture = { reference = "gfx/interface/illustrations/decisions/decision_misc.dds" }
    sort_order = 18
    ai_check_interval = 12
    desc = riseandfall_grant_counties_desc
    selection_tooltip = riseandfall_grant_counties_desc
    decision_group_type = riseandfall

    is_shown = { is_landed = yes NOT = { exists = global_var:riseandfall_hide_other_decisions } }

    is_valid = { is_landed = yes }

    # Manual grant: run the counties grant scripted effect immediately
    effect = { riseandfall_grant_counties_se = yes }

    # AI: only consider this decision if AI and they're over the domain limit
    # domain_limit_available is negative when above the limit; this AI check wants strongly over the limit
    ai_potential = { domain_limit_available < -20 }

    # Make AI very likely to pick this when ai_potential is true
    ai_will_do = { base = 100 }
}


riseandfall_enable_hide_mod_decisions = {
    picture = { reference = "gfx/interface/illustrations/decisions/decision_misc.dds" }
    sort_order = 8
    ai_check_interval = 0
    desc = riseandfall_enable_hide_mod_decisions_desc
    selection_tooltip = riseandfall_enable_hide_mod_decisions_tooltip
    decision_group_type = riseandfall

    is_shown = { always = no }

    is_valid = { is_landed = yes }

    effect = { set_global_variable = { name = riseandfall_hide_other_decisions value = yes } }

    ai_potential = {}
    ai_will_do = { base = 0 }
} 


riseandfall_disable_hide_mod_decisions = {
    picture = { reference = "gfx/interface/illustrations/decisions/decision_misc.dds" }
    sort_order = 9
    ai_check_interval = 0
    desc = riseandfall_disable_hide_mod_decisions_desc
    selection_tooltip = riseandfall_disable_hide_mod_decisions_tooltip
    decision_group_type = riseandfall

    is_shown = { always = no }

    is_valid = { is_landed = yes }

    effect = { remove_global_variable = riseandfall_hide_other_decisions }

    ai_potential = {}
    ai_will_do = { base = 0 }
}


# Menu: show a popup with Hide / Show options (widget-based)
riseandfall_hide_mod_decision_menu = {
    picture = { reference = "gfx/interface/illustrations/decisions/decision_misc.dds" }
    sort_order = 7
    ai_check_interval = 0
    desc = riseandfall_hide_mod_decision_menu_desc
    selection_tooltip = riseandfall_hide_mod_decision_menu_tooltip
    decision_group_type = riseandfall

    is_shown = { always = yes }

    is_valid = { is_landed = yes }

    widget = {
        gui = "decision_view_widget_option_list_generic"
        controller = decision_option_list_controller
        decision_to_second_step_button = "CHOOSE_CHARACTER_ROLE_DECISION_NEXT_STEP_BUTTON"
        show_from_start = yes

        item = {
            value = riseandfall_enable_hide_mod_decisions
            is_shown = { NOT = { exists = global_var:riseandfall_hide_other_decisions } }
            is_valid = { is_landed = yes }
            current_description = riseandfall_enable_hide_mod_decisions_desc
            localization = riseandfall_enable_hide_mod_decisions
            icon = "gfx/interface/illustrations/decisions/decision_misc.dds"
        }

        item = {
            value = riseandfall_disable_hide_mod_decisions
            is_shown = { exists = global_var:riseandfall_hide_other_decisions }
            is_valid = { is_landed = yes }
            current_description = riseandfall_disable_hide_mod_decisions_desc
            localization = riseandfall_disable_hide_mod_decisions
            icon = "gfx/interface/illustrations/decisions/decision_misc.dds"
        }
    }

    effect = {
        custom_tooltip = riseandfall_hide_mod_decision_menu_tt
        hidden_effect = {
            custom_tooltip = riseandfall_hide_mod_decision_menu_tooltip_tt
            if = {
                limit = { scope:riseandfall_enable_hide_mod_decisions = yes }
                set_global_variable = { name = riseandfall_hide_other_decisions value = yes }
            }
            else_if = {
                limit = { scope:riseandfall_disable_hide_mod_decisions = yes }
                remove_global_variable = riseandfall_hide_other_decisions
            }
        }
    }
}
