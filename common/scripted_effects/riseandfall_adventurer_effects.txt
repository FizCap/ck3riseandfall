riseandfall_check_dynasty_for_adventurers_se = {
    # Expecting character scope (independent ruler). Check their dynasty members.
    if = {
        limit = { has_dynasty = yes }
        dynasty = {
            every_dynasty_member = {
                limit = {
                    is_landed = no
                    is_alive = yes
                    NOT = { has_government = landless_adventurer_government }
                    age >= 16
                    any_claim = { tier >= tier_kingdom }
                }
                riseandfall_turn_into_adventurer_se = yes
            }
        }
    }
}

riseandfall_turn_into_adventurer_se = {
    random_list = {
        99 = {  # chance weight 99
            save_scope_as = adventurer_child
            create_adventurer_title = {
                name = riseandfall_adventurer_title_name
                holder = scope:adventurer_child
                save_scope_as = created_adventurer_title
            }
            # Set camp law on the created adventurer's camp
            scope:adventurer_child = {
                add_realm_law = camp_purpose_legitimists
                # Give starting gold equal to one year's worth of the independent ruler's income
                # plus 20% of the independent ruler's current gold
                set_variable = { name = adventurer_starting_gold value = scope:independent_ruler.monthly_character_income }
                change_variable = { name = adventurer_starting_gold multiply = 12 }

                # Compute 20% of the ruler's current gold and add it to the starting amount
                set_variable = { name = adventurer_gold_percent value = scope:independent_ruler.gold }
                change_variable = { name = adventurer_gold_percent multiply = 0.2 }
                change_variable = { name = adventurer_starting_gold add = var:adventurer_gold_percent }

                # Final rounding and cleanup
                round_variable = { name = adventurer_starting_gold nearest = 1 }

                # Give starting gold (same regardless of claim tier) and apply baseline modifier
                add_gold = var:adventurer_starting_gold
                add_character_modifier = { modifier = riseandfall_adventurer_gold_mod }

                remove_variable = adventurer_starting_gold
            }
            scope:adventurer_child = {
                # Calculate 10% of independent ruler's max strength
                set_variable = { name = adventurer_army_size value = scope:independent_ruler.max_military_strength }
                change_variable = { name = adventurer_army_size multiply = 0.8 }

                # Choose a random multiplier between 0.5 and 2.0 for army size
                set_variable = { name = adventurer_multiplier value = 1 }
                random_list = {
                    1 = { set_variable = { name = adventurer_multiplier value = 0.5 } }
                    1 = { set_variable = { name = adventurer_multiplier value = 0.6 } }
                    1 = { set_variable = { name = adventurer_multiplier value = 0.7 } }
                    1 = { set_variable = { name = adventurer_multiplier value = 0.8 } }
                    1 = { set_variable = { name = adventurer_multiplier value = 0.9 } }
                    1 = { set_variable = { name = adventurer_multiplier value = 1.0 } }
                    1 = { set_variable = { name = adventurer_multiplier value = 1.1 } }
                    1 = { set_variable = { name = adventurer_multiplier value = 1.2 } }
                    1 = { set_variable = { name = adventurer_multiplier value = 1.3 } }
                    1 = { set_variable = { name = adventurer_multiplier value = 1.4 } }
                    1 = { set_variable = { name = adventurer_multiplier value = 1.5 } }
                    1 = { set_variable = { name = adventurer_multiplier value = 1.6 } }
                    1 = { set_variable = { name = adventurer_multiplier value = 1.7 } }
                    1 = { set_variable = { name = adventurer_multiplier value = 1.8 } }
                    1 = { set_variable = { name = adventurer_multiplier value = 1.9 } }
                    1 = { set_variable = { name = adventurer_multiplier value = 2.0 } }
                }
                change_variable = { name = adventurer_army_size multiply = var:adventurer_multiplier }
                round_variable = { name = adventurer_army_size nearest = 1 }

                spawn_army = {
                    name = riseandfall_adventurer_host_name
                    levies = var:adventurer_army_size
                    inheritable = no
                    reinforce = yes
                    location = scope:independent_ruler.capital_province
                    save_scope_as = new_army
                }


                remove_variable = adventurer_army_size
                remove_variable = adventurer_multiplier
            }
        }
        1 = {
            # Nothing happens in this branch
        }
    }
}

