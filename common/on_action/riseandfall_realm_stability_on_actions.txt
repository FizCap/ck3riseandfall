# On_actions for the Realm Stability mechanic
# This file isolates the realm stability on_action so it can be enabled, disabled,
# or scheduled independently from adventurer logic.

yearly_global_pulse = {
    on_actions = {
        riseandfall_yearly_realm_stability
        riseandfall_ai_create_kingdoms
        riseandfall_ai_create_duchies
        riseandfall_ai_create_empires
    }
}

on_game_start_after_lobby = {
    on_actions = {
        riseandfall_yearly_realm_stability
    }
}

riseandfall_yearly_realm_stability = {
    trigger = {
        has_game_rule = riseandfall_realm_stability_enabled
    }
    effect = {
        every_ruler = {
            save_scope_as = independent_ruler
            scope:independent_ruler = {
                riseandfall_calculate_realm_stability_se = yes
            }
        }
    }
}

riseandfall_ai_create_kingdoms = {
    trigger = {
        has_game_rule = riseandfall_ai_kingdom_creation_enabled
    }
    effect = {
        riseandfall_ai_create_kingdoms_se = yes
    }
}

riseandfall_ai_create_duchies = {
    trigger = {
        has_game_rule = riseandfall_ai_kingdom_creation_enabled
    }
    effect = {
        riseandfall_ai_create_duchies_se = yes
    }
}

riseandfall_ai_create_empires = {
    trigger = {
        has_game_rule = riseandfall_ai_kingdom_creation_enabled
    }
    effect = {
        riseandfall_ai_create_empires_se = yes
    }
}